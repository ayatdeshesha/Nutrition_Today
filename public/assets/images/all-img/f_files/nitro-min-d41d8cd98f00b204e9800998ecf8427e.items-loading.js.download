(function(e){e(function(){e(".post-list, .ajax-list").each(function(){var t=e(this);var a=jQuery([]);var i=jQuery([]);var n=0;var o=0;var r=jQuery([]);var s=false;var f="";var l=0;var c=creepy_data.posts_per_page;var d=t.hasClass("ajax-list");var u=t.hasClass("post-list");function p(){if(jQuery.contains(document.documentElement,r[0])){s=r.offset().top-e(window).height()-creepy_data.preload_distance}else{s=false}}window.addEventListener("resize",p);t.on("layoutComplete",p);function h(e){a=a.add(e);i=i.add(e);o+=e.length}function v(t){var a=t.find(".cover-img");a.each(function(){$img=e(this);var t=$img.attr("width");var a=$img.attr("height");$img.css("height",$img.width()*a/t+"px")})}if(u){window.addEventListener("resize",function(){v(t)})}function g(){f=t.data("post-type");h(t.find(".item"));if(u){v(t);t.parent()[0].style.height=t.parent().height()+"px";t.masonry({itemSelector:".item",columnWidth:".item",initLayout:false,transitionDuration:0});t.masonry("once","layoutComplete",function(){t.parent()[0].style.height=""});t.masonry()}i=jQuery([]);r=e('<div class="ajax-loader"></div>');if(d){if(typeof t.data("posts-count")!=="undefined"){l=parseInt(t.data("posts-count"))}else{l=o}if(a.length){r.insertAfter(t)}p();j()}}var m;function y(a,i,n){if(m){return}m=true;var r=["favorite","seed","most_downloaded","time","tag","search","author","user"];var s={};s.count=o;s.action="items_loading_ajax";s.posts_count=l;for(var f=r.length-1;f>=0;f--){var c=t.data(r[f]);if(typeof c!=="undefined"){s[r[f]]=c}}request=e.ajax({url:creepy_data.ajax_url,type:"post",dataType:"html",data:s});request.done(function(t,n,o){var r=e(t).filter(".item");h(r);m=false;l+=parseInt(creepy_data.posts_per_page);if(r.length){if(typeof a=="function")a.call(this)}else{if(typeof i=="function")i.call(this)}return true});request.fail(function(e,t,a){console.log("error");console.log(t);m=false;if(typeof n=="function"){n.call(this)}else if(typeof i=="function"){i.call(this)}return false})}function w(){r[0].parentNode.removeChild(r[0]);p()}function j(){if(s!==false&&window.pageYOffset>s){if(n<=0){$(c)}}}e(window).on("scroll",j);function _(){var e=Math.ceil(l/c);var t=window.location.pathname;var a=window.location.search;var i=window.location.hash;if(a){var n=new RegExp("([?&])(spage=[^&]*|spage)(&.*)?$");if(a.match(n)){a=a.replace(n,"$1spage="+e+"$3")}else{a+="&spage="+e}}else{a="?spage="+e}var o=t+a+i;var r={Url:o};window.history.replaceState(r,"",o)}function $(a){if(typeof a!=="undefined"){n=a}while(n>0){if(!i.length){y($,w);return}t.append(i);p();i.each(function(){$item=e(this);v($item);var t=$item.data("event");if(t){if(Object.prototype.toString.call(t)==="[object Array]"){e.each(t,function(){$item.trigger(this)})}else{$item.trigger(t)}}});if(u){t.masonry("appended",i)}var o=i.length;n-=o;i=i.slice(o);_()}j()}g()})})})(jQuery);